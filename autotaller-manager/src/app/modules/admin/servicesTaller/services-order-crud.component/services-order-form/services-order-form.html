<div class="container py-5" style="max-width: 600px; margin-top: 80px">
  <h2 class="mb-4 text-white">
    {{ editMode ? "Editar Orden de Servicio" : "Nueva Orden de Servicio" }}
  </h2>

  <form #serviceOrderForm="ngForm" (ngSubmit)="save()">
    <div class="mb-3">
      <label class="form-label text-white">Descripción *</label>
      <input
        type="text"
        class="form-control"
        [(ngModel)]="serviceOrder.description"
        name="description"
        #description="ngModel"
        required
        [class.is-invalid]="description.invalid && description.touched"
      />
      <div class="invalid-feedback" *ngIf="description.invalid && description.touched">
        La descripción es requerida
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label text-white">Vehículo *</label>
      <select
        class="form-select"
        [(ngModel)]="serviceOrder.serialNumber"
        name="serialNumber"
        #serialNumber="ngModel"
        required
        [class.is-invalid]="serialNumber.invalid && serialNumber.touched"
      >
        <option [ngValue]="null" disabled>Seleccione un vehículo</option>
        <option *ngFor="let vehicle of vehicles" [ngValue]="vehicle">
          {{ vehicle.serialNumber }}
        </option>
      </select>
      <div class="invalid-feedback" *ngIf="serialNumber.invalid && serialNumber.touched">
        El vehículo es requerido
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label text-white">Tipo de Servicio *</label>
      <select
        class="form-select"
        [(ngModel)]="serviceOrder.serviceType"
        name="serviceType"
        #serviceType="ngModel"
        required
        [class.is-invalid]="serviceType.invalid && serviceType.touched"
      >
        <option [ngValue]="null" disabled>Seleccione un tipo</option>
        <option *ngFor="let type of serviceTypes" [ngValue]="type">
          {{ type.description }}
        </option>
      </select>
      <div class="invalid-feedback" *ngIf="serviceType.invalid && serviceType.touched">
        El tipo de servicio es requerido
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label text-white">Técnico *</label>
      <select
        class="form-select"
        [(ngModel)]="serviceOrder.UserMember"
        name="user"
        #user="ngModel"
        required
        [class.is-invalid]="user.invalid && user.touched"
      >
        <option [ngValue]="null" disabled>Seleccione un técnico</option>
        <option *ngFor="let user of users" [ngValue]="user">
          {{ user.name }} {{ user.lastname }}
        </option>
      </select>
      <div class="invalid-feedback" *ngIf="user.invalid && user.touched">
        El técnico es requerido
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label text-white">Precio Unitario *</label>
      <input
        type="number"
        class="form-control"
        [(ngModel)]="serviceOrder.unitPrice"
        name="unitPrice"
        #unitPrice="ngModel"
        required
        min="0"
        [class.is-invalid]="unitPrice.invalid && unitPrice.touched"
      />
      <div class="invalid-feedback" *ngIf="unitPrice.invalid && unitPrice.touched">
        Ingrese un precio válido
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label text-white">Estado *</label>
      <select
        class="form-select"
        [(ngModel)]="serviceOrder.status"
        name="status"
        #status="ngModel"
        required
        [class.is-invalid]="status.invalid && status.touched"
      >
        <option [ngValue]="null" disabled>Seleccione un estado</option>
        <option *ngFor="let st of statuses" [ngValue]="st">
          {{ st.description }}
        </option>
      </select>
      <div class="invalid-feedback" *ngIf="status.invalid && status.touched">
        El estado es requerido
      </div>
    </div>

    <div class="form-check mb-4">
      <input
        class="form-check-input"
        type="checkbox"
        [(ngModel)]="serviceOrder.clientApproved"
        name="clientApproved"
        id="clientApproved"
      />
      <label class="form-check-label text-white" for="clientApproved">
        Aprobado por el cliente
      </label>
    </div>

    <div class="d-flex justify-content-between mt-4">
      <button type="submit" class="btn btn-primary" [disabled]="serviceOrderForm.invalid">
        {{ editMode ? 'Actualizar' : 'Crear' }} Orden
      </button>
      <button type="button" class="btn btn-secondary" (click)="cancel()">
        Cancelar
      </button>
    </div>
  </form>
</div>
